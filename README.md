# Лабораторная работа №5: Многопоточность в C++

**Цель работы**: изучить создание и управление потоками в C++ с использованием `std::thread`, механизмы синхронизации (`std::mutex`, `std::atomic`), а также реализовать параллельный алгоритм обработки изображений (размытие) для повышения производительности.

## Структура проекта

```
lab5/
├── CMakeLists.txt
├── README.md
└── src/
    ├── blur.cpp
    └── atomic_example.cpp
```

## Последовательное размытие изображения

В `blur.cpp` реализована функция `sequentialBlur`, которая для каждого пикселя вычисляет среднее значение его соседей в окне 3×3. Границы обрабатываются копированием исходных значений.

## Параллельное размытие с `std::thread`

Функция `parallelBlurThreads` делит изображение на горизонтальные полосы по числу аппаратных потоков (`std::thread::hardware_concurrency()`). Каждый поток обрабатывает свою полосу без использования мьютексов, поскольку запись идет в отдельную область выходного изображения.

## Пример атомарных операций

В `atomic_example.cpp` показан пример увеличения общего счетчика двумя способами:
1. С защитой `std::mutex`.
2. С использованием `std::atomic<int>`.

Результаты выполнения (время и итоговое значение) выводятся в консоль.

## Сборка и запуск

```bash
mkdir build && cd build
cmake ..
make
```

### Запуск размытия

```bash
# Формат: ./blur <input_image> <output_sequential> <output_parallel>
./blur ../images/input.jpg output_seq.jpg output_par.jpg
```

### Запуск примера атомарного счётчика

```bash
./atomic_example
```

## Измерение производительности

Пример таблицы для результатов (заполните своими данными):

| Версия             | Время (мс) |
|--------------------|------------|
| Последовательная   |            |
| Параллельная       |            |
| Mutex vs Atomic    |            |

## Выводы

- Многопоточность позволяет значительно ускорить вычисления при обработке больших данных.
- `std::mutex` обеспечивает безопасность, но может стать узким местом.
- `std::atomic` эффективен для простых операций, избегает накладных расходов блокировок.
